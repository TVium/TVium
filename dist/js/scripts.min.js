var Constants={VERSION:"0.1.0",CONFIG_FILE:"config/hbbtvConfig.json",CONFIG_FILE_TIMEOUT:3e4,LANG_FOLDER:"config/languages",CONSENT_BANNER_DISPLAY_TIME:1e4,CONSENT_CONFIRMATION_DISPLAY_TIME:5e3,COOKIES_MONTHS_DURATION:6,MODEL_COOKIE_NAME:"appData"};if(void 0===VK_LEFT)var VK_LEFT=37,VK_UP=38,VK_RIGHT=39,VK_DOWN=40;if(void 0===VK_ENTER)var VK_ENTER=13;if(void 0===VK_RED)var VK_RED=82,VK_GREEN=86,VK_YELLOW=74,VK_BLUE=66;if(void 0===VK_PLAY)var VK_PLAY=80,VK_PAUSE=81,VK_STOP=83;if(void 0===VK_FAST_FWD)var VK_FAST_FWD=70,VK_REWIND=82;if(void 0===VK_BACK)var VK_BACK=166;if(void 0===VK_0)var VK_0=48,VK_1=49,VK_2=50,VK_3=51,VK_4=52,VK_5=53,VK_6=54,VK_7=55,VK_8=56,VK_9=57;var app=null,logManager=null,konamiManager=null,serviceManager=null,consentManager=null,configManager=null,storageManager=null,labelsManager=null,featuresManager=null,keyset=null,trackingConsent=null,yellowButtonEnabled=!1,activeContext=null;function extend(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}window.onload=function(){try{(logManager=new LogManager).generalLog("User Agent - "+navigator.userAgent),logManager.generalLog("App Host - "+window.location.host);try{var e=document.getElementById("appMan");(app=e.getOwnerApplication(document)).show(),keyset=app.privateData.keyset}catch(e){logManager.generalError(e.message)}try{(configManager=new ConfigurationManager).initPlatformData(),logManager.generalLog("HbbTvVersion: "+configManager.getPlatform().hbbtvversion+" - Brand: "+configManager.getPlatform().brand+" - Model: "+configManager.getPlatform().model),configManager.loadRemoteAppConfiguration(function(){(featuresManager=new FeaturesManager).loadFeaturesConfiguration(function(){(serviceManager=new ServiceManager).initialize(),(labelsManager=new LabelsManager).init(),storageManager=new StorageManager,logManager.log("getConsent wait-time started"),(consentManager=new ConsentManager(t,n)).init(),setTimeout(function(){consentManager.loadConsentData(function(e){consentManager.consentsDirectValidationOverlayComponent.showConsentDirectValidationOverlay(e)},function(e){})},configManager.getConfigurations().TIME_BEFORE_CONSENT_CALL)})},function(e){logManager.generalError(e)})}catch(e){logManager.generalError(e.message)}(konamiManager=new KonamiManager).loadKonamis(),n();try{logManager.generalLog("Keyset bound: "+JSON.stringify(keyset,null,4)+" - Example key (yellow button): "+keyset.YELLOW)}catch(e){logManager.generalError("Init Keyset: "+e.message)}}catch(e){logManager.generalError("General Error: "+e.message)}function n(){try{var e=keyset.YELLOW;keyset.setValue(e)}catch(e){logManager.generalError("General Error: "+e.message)}}function t(){try{keyset.setValue(0)}catch(e){logManager.generalError("General Error: "+e.message)}}},Element.prototype.addClass=function(e){$(this).addClass(e)},Element.prototype.removeClass=function(e){$(this).removeClass(e)},Number.prototype.padLeft=function(e,n){var t=String(e||10).length-String(this).length+1;return 0<t?new Array(t).join(n||"0")+this:this},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Object.keys||(Object.keys=function(){"use strict";var o=Object.prototype.hasOwnProperty,s=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=r.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var n,t,a=[];for(n in e)o.call(e,n)&&a.push(n);if(s)for(t=0;t<i;t++)o.call(e,r[t])&&a.push(r[t]);return a}}());var Channel=function(e){var n=e;this.getChannelObj=function(){return n},this.getChannelToString=function(){return n&&n.onid||(logManager.log("current channel obj is null or has no triplet - reloading current channel obj from broadcast object"),n=serviceManager.getObjVideo().currentChannel,logManager.log("new channel obj: "+n)),n.onid+"."+n.tsid+"."+n.sid},this.isChannelEqualTo=function(e){return e.getChannelToString()===n.getChannelToString()}};ConfigurationManager=function(){var s=null,r=null,a={brand:"",model:"",hbbtvversion:""};this.initPlatformData=function(){var e,n=window.navigator.userAgent.match(/HbbTV\/\d\.(\d).(\d)/g)[0];if(n){a.hbbtvversion=n;var t=window.navigator.userAgent.substring(window.navigator.userAgent.indexOf(n)+n.length).match(/\(([^)]+)\)/)[1];t&&(e=t.split(";"))}e&&2<=e.length&&(a.brand=e[1]),e&&3<=e.length&&(a.model=e[2])},this.getPlatform=function(){return a},this.loadRemoteAppConfigurationPromise=function(){return new Promise(function(a,o){try{$.ajax({type:"GET",url:Constants.CONFIG_FILE,contentType:"application/json",dataType:"json",timeout:Constants.CONFIG_FILE_TIMEOUT}).done(function(e,n,t){s=e,logManager.log("remoteConfiguration:"+JSON.stringify(e,null,4)),r=Object.assign(s,Constants),logManager.log(JSON.stringify(r,null,4)),a()}).fail(function(e,n,t){var a=n+" - "+JSON.stringify(e.responseJSON);o(serviceName+" - KO "+a)})}catch(e){o(e.message)}})},this.loadRemoteAppConfiguration=function(n,t){try{logManager.generalLog(Constants.CONFIG_FILE+" loading..."),$.ajax({type:"GET",url:Constants.CONFIG_FILE,contentType:"application/json",dataType:"json",timeout:Constants.CONFIG_FILE_TIMEOUT,success:function(e){logManager.generalLog(Constants.CONFIG_FILE+" LOADED!"),r=extend(s=e,Constants),logManager.generalLog("Server config file and app config file are merged"),logManager.generalLog(JSON.stringify(r,null,4)),n()},error:function(e){logManager.generalError(Constants.CONFIG_FILE+" ERROR!");var n=JSON.stringify(e);logManager.generalError(Constants.CONFIG_FILE+" ERROR DESC:"+n),t(n)}})}catch(e){t(e.message)}},this.getConfigurations=function(){return r},this.setConfigurations=function(e,n){null!=r&&(r[e]=n)}};var ConsentManager=function(e,n){var s=this,i=null;this.consentsDirectValidationOverlayComponent=new ConsentsDirectValidationOverlayComponent(e,n),this.consentsConfirmationOverlayComponent=new ConsentsConfirmationOverlayComponent(e,n),this.consentsParametersOverlayComponent=new ConsentsParametersOverlayComponent(e,n),this.consentsPrivacyPolicyComponent=new ConsentsPrivacyPolicyComponent(e,n),this.consentsPartnerComponent=new ConsentsPartnerComponent(e,n),this.consentsErrorComponent=new ConsentsErrorComponent(e,n),this.init=function(){var e=storageManager.getCookie(configManager.getConfigurations().MODEL_COOKIE_NAME);null!=e&&(i=JSON.parse(e))},this.editAllConsentAndSend=function(e,t){for(var n=0;n<i.consents.length;n++){var a=n;i.consents[a].consentStatus=e}s.sendConsents(function(e){t.removeKeyboardEvents();var n=null;null!=e&&null!=e&&(n=e),s.consentsConfirmationOverlayComponent.showConsentConfirmationOverlay(n)},function(){logManager.error("postConsent Error"),t.removeKeyboardEvents(),s.consentsErrorComponent.showConsentError()})},this.consentsDirectValidationOverlayComponent.setEnterKeyEventHandler(function(){try{switch(s.consentsDirectValidationOverlayComponent.getCurrentPosition()){case 0:s.editAllConsentAndSend(!0,s.consentsDirectValidationOverlayComponent);break;case 1:s.editAllConsentAndSend(!1,s.consentsDirectValidationOverlayComponent);break;case 2:s.consentsDirectValidationOverlayComponent.removeKeyboardEvents(),s.consentsParametersOverlayComponent.init(i),s.consentsParametersOverlayComponent.showConsentParametersOverlay(yellowButtonEnabled);break;case 3:s.consentsDirectValidationOverlayComponent.manageShowPrivacyPolicy();break;case 4:s.consentsDirectValidationOverlayComponent.manageShowPartner()}}catch(e){logManager.error(e.message)}}),this.consentsDirectValidationOverlayComponent.manageShowPrivacyPolicy=function(){s.consentsDirectValidationOverlayComponent.removeKeyboardEvents(),s.consentsPrivacyPolicyComponent.showConsentPrivacyPolicy("validation")},this.consentsDirectValidationOverlayComponent.manageShowPartner=function(){s.consentsDirectValidationOverlayComponent.removeKeyboardEvents(),s.consentsPartnerComponent.showConsentPartner("validation")},this.consentsPrivacyPolicyComponent.setEnterKeyEventHandler(function(){if($(".tvium-container .focused")[0]){var e=$(".tvium-container .focused")[0].id,n=$("#backButton").attr("pagefrom");switch(e){case"backButton":s.consentsPrivacyPolicyComponent.removeKeyboardEvents(),"validation"==n?s.consentsDirectValidationOverlayComponent.showConsentDirectValidationOverlay():"parameters"==n?s.consentsParametersOverlayComponent.showConsentParametersOverlay(yellowButtonEnabled):"partenaires"==n&&s.consentsPartnerComponent.showConsentPartner("")}}}),this.consentsPrivacyPolicyComponent.setBackKeyEventHandler(function(){var e=$("#backButton").attr("pagefrom");s.consentsPrivacyPolicyComponent.removeKeyboardEvents(),"validation"==e?s.consentsDirectValidationOverlayComponent.showConsentDirectValidationOverlay():"parameters"==e?s.consentsParametersOverlayComponent.showConsentParametersOverlay(yellowButtonEnabled):"partenaires"==e&&s.consentsPartnerComponent.showConsentPartner("")}),this.consentsPartnerComponent.setEnterKeyEventHandler(function(){if($(".tvium-container .focused")[0]){var e=$(".tvium-container .focused")[0].id,n=$("#backButton").attr("pagefrom");switch(e){case"backButton":s.consentsPartnerComponent.removeKeyboardEvents(),"validation"==n?s.consentsDirectValidationOverlayComponent.showConsentDirectValidationOverlay():"parameters"==n&&s.consentsParametersOverlayComponent.showConsentParametersOverlay(yellowButtonEnabled);break;case"politique":s.consentsPartnerComponent.removeKeyboardEvents(),s.consentsPrivacyPolicyComponent.showConsentPrivacyPolicy("partenaires")}}}),this.consentsPartnerComponent.setBackKeyEventHandler(function(){var e=$("#backButton").attr("pagefrom");s.consentsPartnerComponent.removeKeyboardEvents(),"validation"==e?s.consentsDirectValidationOverlayComponent.showConsentDirectValidationOverlay():"parameters"==e&&s.consentsParametersOverlayComponent.showConsentParametersOverlay(yellowButtonEnabled)}),this.consentsParametersOverlayComponent.manageShowPrivacyPolicy=function(e){s.consentsParametersOverlayComponent.removeKeyboardEvents(),s.consentsPrivacyPolicyComponent.showConsentPrivacyPolicy("parameters")},this.consentsParametersOverlayComponent.manageShowPartner=function(e){s.consentsParametersOverlayComponent.removeKeyboardEvents(),s.consentsPartnerComponent.showConsentPartner("parameters")},this.consentsParametersOverlayComponent.manageShowErrorMessage=function(){s.consentsParametersOverlayComponent.removeKeyboardEvents();var e=null;null!=i.toRequest&&null!=i.toRequest&&(e=i.toRequest),s.consentsErrorComponent.showConsentError(e)},this.consentsParametersOverlayComponent.setEnterKeyEventHandler(function(e){var n,t;try{if("Oui"!=$(".focused").attr("name")&&"Non"!=$(".focused").attr("name")||$(".focused").hasClass("all"))if("Oui"!=$(".focused").attr("name")&&"Non"!=$(".focused").attr("name")||!$(".focused").hasClass("all"))if("Valider"==$(".focused").attr("name"))s.sendConsents(function(e){s.consentsParametersOverlayComponent.removeKeyboardEvents();var n=null;null!=e&&null!=e&&(n=e),s.consentsConfirmationOverlayComponent.showConsentConfirmationOverlay(n)},function(){logManager.error("postConsent Error"),i=JSON.parse(JSON.stringify(s.consentsParametersOverlayComponent.getAuxContentModel())),s.consentsParametersOverlayComponent.updateModel(i),s.consentsParametersOverlayComponent.removeKeyboardEvents(),s.consentsErrorComponent.showConsentError()});else if($("#backButton").hasClass("focused")){var a=null;null!=i.toRequest&&null!=i.toRequest&&(a=i.toRequest),1==yellowButtonEnabled?(i=JSON.parse(JSON.stringify(s.consentsParametersOverlayComponent.getAuxContentModel())),s.consentsParametersOverlayComponent.updateModel(i),s.consentsParametersOverlayComponent.removeKeyboardEvents()):(i=JSON.parse(JSON.stringify(s.consentsParametersOverlayComponent.getAuxContentModel())),s.consentsParametersOverlayComponent.updateModel(i),s.consentsParametersOverlayComponent.removeKeyboardEvents(),s.consentsDirectValidationOverlayComponent.showConsentDirectValidationOverlay(a))}else $("#politique").hasClass("focused")?(i=JSON.parse(JSON.stringify(s.consentsParametersOverlayComponent.getAuxContentModel())),s.consentsParametersOverlayComponent.updateModel(i),s.consentsParametersOverlayComponent.manageShowPrivacyPolicy("parameters")):$("#partenaires").hasClass("focused")&&(i=JSON.parse(JSON.stringify(s.consentsParametersOverlayComponent.getAuxContentModel())),s.consentsParametersOverlayComponent.updateModel(i),s.consentsParametersOverlayComponent.manageShowPartner("parameters"));else"Oui"==$(".focused").attr("name")?s.editAllConsentAndSend(!0,s.consentsParametersOverlayComponent):s.editAllConsentAndSend(!1,s.consentsParametersOverlayComponent);else $(".focused").parent().nextAll(".consent-section__page__contain__buttons-container").first().children().removeClass("disabled"),0<$(".focused").parent().children(".active").length&&$(".focused").parent().children().removeClass("active"),$(".focused").addClass("active"),t=(n=$(".focused")[0].id).replace("t","").replace("f",""),"t"==n.charAt(0)?parameterValue=!0:parameterValue=!1,s.consentsParametersOverlayComponent.manageDownKeyEvent(),i.consents[parseInt(t)].consentStatus=parameterValue,s.consentsParametersOverlayComponent.updateModel(i)}catch(e){logManager.error(e.message)}}),this.consentsParametersOverlayComponent.setBackKeyEventHandler(function(){try{var e=null;null!=i.toRequest&&null!=i.toRequest&&(e=i.toRequest),1==yellowButtonEnabled?(i=JSON.parse(JSON.stringify(s.consentsParametersOverlayComponent.getAuxContentModel())),s.consentsParametersOverlayComponent.updateModel(i),s.consentsParametersOverlayComponent.removeKeyboardEvents()):(i=JSON.parse(JSON.stringify(s.consentsParametersOverlayComponent.getAuxContentModel())),s.consentsParametersOverlayComponent.updateModel(i),s.consentsParametersOverlayComponent.removeKeyboardEvents(),s.consentsDirectValidationOverlayComponent.showConsentDirectValidationOverlay(e))}catch(e){logManager.error(e.message)}}),this.loadConsentData=function(s,r){(new RequestPlatform).getConsentGET(function(e){i=e,storageManager.setCookie(configManager.getConfigurations().MODEL_COOKIE_NAME,JSON.stringify(i));for(var n=!0,t=0;t<e.consents.length;t++){var a=t;"TRACKING"==e.consents[a].purposeName&&(trackingConsent=e.consents[a].consentStatus),null==e.consents[a].consentStatus&&(n=!1)}var o=0!=e.toRequest;o?s(e.toRequest):1==n&&(yellowButtonEnabled=!0),r(o)},function(){logManager.error("getConsent Error")})},this.sendConsents=function(n,e){try{for(var t=s.parseModelForPost(i),a=0;a<i.consents.length;a++){var o=a;"TRACKING"==i.consents[o].purposeName&&(trackingConsent=i.consents[o].consentStatus)}(new RequestPlatform).getConsentPOST(function(e){storageManager.setCookie(configManager.getConfigurations().MODEL_COOKIE_NAME,JSON.stringify(consentManager.getModel())),n(e.toAcknowledge)},function(){e()},t)}catch(e){logManager.error(e.message)}},this.parseModelForPost=function(e){try{for(var n={tvId:consentManager.getModel().tvId,consents:[]},t=0;t<e.consents.length;t++){var a=t,o={purposeName:e.consents[a].purposeName,consentStatus:e.consents[a].consentStatus,purposeId:e.consents[a].purposeId};n.consents.push(o)}return n}catch(e){logManager.error(e.message)}},this.getModel=function(){return i},this.getModelConsents=function(){for(var e=[],n=0;n<i.consents.length;n++){var t=n,a={purposeName:i.consents[t].purposeName,consentStatus:i.consents[t].consentStatus,purposeId:i.consents[t].purposeId};e[i.consents[t].purposeName]=a}return e}},FeaturesManager=function(){var s;this.loadFeaturesConfiguration=function(o){$.ajax({type:"GET",url:configManager.getConfigurations().FEATURES_FILE,contentType:"application/json",dataType:"json"}).done(function(e,n,t){try{for(var a=0;a<e.devices.length;a++)if(null==e.devices[a].userAgentInfo.brand.trim()&&(e.devices[a].userAgentInfo.brand=""),null==e.devices[a].userAgentInfo.model.trim()&&(e.devices[a].userAgentInfo.model=""),null==e.devices[a].userAgentInfo.others.trim()&&(e.devices[a].userAgentInfo.others=""),null!=window.navigator.userAgent&&-1<window.navigator.userAgent.toUpperCase().indexOf(e.devices[a].userAgentInfo.brand.toUpperCase().trim())&&-1<window.navigator.userAgent.toUpperCase().indexOf(e.devices[a].userAgentInfo.model.toUpperCase().trim())&&-1<window.navigator.userAgent.toUpperCase().indexOf(e.devices[a].userAgentInfo.others.toUpperCase().trim())){s=e.devices[a].features,logManager.log('Brand matching: "'+e.devices[a].userAgentInfo.brand.trim()+'"\nModel matching: "'+e.devices[a].userAgentInfo.model.trim()+'"\nOthers matching: "'+e.devices[a].userAgentInfo.others.trim()+'"\nFeatures loaded: '+JSON.stringify(s,null,4));break}null!=s&&""!==s||logManager.warning("Client not found in Features Whitelist. User Agent: "+window.navigator.userAgent),o()}catch(e){logManager.generalError(e.message)}}).fail(function(e,n,t){logManager.log(t)})},this.getFeature=function(e){return null!=s[e]?s[e]:s},this.setFeature=function(e,n){null!=s[e]&&(s[e]=n)}},KonamiManager=function(){var n={EDIT_CONSENT:{pattern:""+KeyEvent.VK_YELLOW,code:function(){!0===yellowButtonEnabled&&(consentManager.consentsParametersOverlayComponent.init(consentManager.getModel()),consentManager.consentsParametersOverlayComponent.showConsentParametersOverlay(yellowButtonEnabled))}}};function t(e){var n=new Konami;n.pattern=e.pattern,n.code=e.code,n.load()}return{loadKonamis:function(){for(var e in n)n.hasOwnProperty(e)&&t(n[e])}}},LabelsManager=function(){var a;this.init=function(){$.ajax({type:"GET",url:Constants.LANG_FOLDER+"/labels."+configManager.getConfigurations().LANGUAGE+".json",contentType:"application/json",dataType:"json"}).done(function(e,n,t){a=e}).fail(function(e,n,t){logManager.log(t)})},this.getLabel=function(e){return null!=a[e]?a[e].replace("\n","<br />"):""}},LogManager=function(){return{generalLog:function(e){var n=new Date,t=[n.getHours().padLeft(),n.getMinutes().padLeft(),n.getSeconds().padLeft(),n.getMilliseconds().padLeft()].join(":")+" - "+e;t=t.replace(/&/g,"#"),console.log(t)},log:function(e){if(null!=configManager&&1==configManager.getConfigurations().ENABLE_LOGS){var n=new Date,t=[n.getHours().padLeft(),n.getMinutes().padLeft(),n.getSeconds().padLeft(),n.getMilliseconds().padLeft()].join(":")+" - "+e;t=t.replace(/&/g,"#"),console.log(t)}},generalError:function(e){var n=new Date,t=[n.getHours().padLeft(),n.getMinutes().padLeft(),n.getSeconds().padLeft(),n.getMilliseconds().padLeft()].join(":")+" -  ERROR: "+e;t=t.replace(/&/g,"#"),console.error(t)},error:function(e){if(null!=configManager&&1==configManager.getConfigurations().ENABLE_LOGS){var n=new Date,t=[n.getHours().padLeft(),n.getMinutes().padLeft(),n.getSeconds().padLeft(),n.getMilliseconds().padLeft()].join(":")+" - ERROR: "+e;t=t.replace(/&/g,"#"),console.error(t)}},warning:function(e){if(configManager&&1==configManager.getConfigurations().ENABLE_LOGS){var n=new Date,t=[n.getHours().padLeft(),n.getMinutes().padLeft(),n.getSeconds().padLeft(),n.getMilliseconds().padLeft()].join(":")+" - WARNING: "+e;t=t.replace(/&/g,"#"),console.warn(t)}}}},ServiceManager=function(){var s=null,n=null;function e(e){n=new Channel(e)}function t(e){var n=e.onid+"."+e.tsid+"."+e.sid;getChannelToString()!=n&&app.destroyApplication()}function a(e,n){logManager.log("onChannelChangeError() - "+n+" - playstate:"+function(){if(s)try{return o(s.playState)}catch(e){return" error: "+e.message}else logManager.warning("The application is broadcast indipendet, press GREEN button to attach to broadcast")}())}function o(e){return 0==e?"Unrelized":1==e?"Connecting":2==e?"Presenting":3==e?"stopped":"not defined: "+e}return{initialize:function(){try{if(s=document.getElementById("video")){if(logManager.log("binding.. to current channel"),featuresManager.getFeature("bindToCurrentChannel"))try{s.bindToCurrentChannel(),logManager.log("objVideo.bindToCurrentChannel() executed correctly")}catch(e){logManager.error("Error executing bindToCurrentChannel() method. Channel data not retrieved.")}logManager.log("setting.. full screen"),s.setFullScreen(!1),logManager.log("attaching.. to onChannelChangeSucceeded event"),s.onChannelChangeSucceeded=t,logManager.log("attaching.. to onChannelChangeKO event"),s.onChannelChangeError=a,logManager.log("attaching.. to onPlayStateChange event"),s.onPlayStateChange=function(e,n){n?logManager.log("onPlayStateChange() - new state: "+o(e)+" - error:"+n):logManager.log("onPlayStateChange() - new state: "+o(e))},logManager.log("saving.. the current triplet"),e(s.currentChannel)}else logManager.log("html tag 'video' broadcast not found")}catch(e){logManager.error("ServiceManager.initialize() - "+e.message)}},setChannel:function(n,t,a){var e,o=null;logManager.log("change channel to:"+n+"."+t+"."+a);try{s?e=s.getChannelConfig().channelList:logManager.warning("The application is broadcast indipendet, press GREEN button to attach to broadcast")}catch(e){throw logManager.warning("get channelList failed ",e),e}try{o=e.getChannelByTriplet(n,t,a)}catch(e){throw logManager.warning("getChannelByTriplet failed for "+n+"."+t+"."+a,e),e}try{logManager.log("Setting channel, waiting for onChannelChangeSucceeded..."),s.setChannel(o,!1)}catch(e){throw logManager.warning("setChannel("+o+") failed",e),e}},getObjVideo:function(){return s},bindToCurrentChannel:function(){try{s.bindToCurrentChannel(),logManager.log("objVideo binded")}catch(e){logManager.log("bindToCurrentChannel ERROR: "+e.message)}},setFullScreen:function(){try{s.setFullScreen(!0),logManager.log("setFullScreen ok")}catch(e){logManager.log("setFullScreen ERROR: "+e.message)}},stopBroadcast:function(){if(s)try{s.stop(),logManager.log("broadcast stopped")}catch(e){logManager.warning("stopBroadcast() - error:"+e.message)}else logManager.error("stopBroadcast() - objVideo broadcast not set")},startBroadcast:function(){if(s)try{s.bindToCurrentChannel(),logManager.log("broadcast binded")}catch(e){logManager.warning("startBroadcast() - error:"+e.message)}else logManager.error("startBroadcast() - objVideo broadcast not set")},getCurrentChannel:function(){return n},setCurrentChannel:e}},StorageManager=function(){this.setCookie=function(e,n){var t=this.getCookie("consentDate"),a="",o=window.location.hostname;if(null!=t)a=" expires="+new Date(parseInt(t)).toUTCString()+";";else{var s=new Date,r=new Date(s.setMonth(s.getMonth()+configManager.getConfigurations().COOKIES_MONTHS_DURATION));a=" expires="+r.toUTCString()+";",document.cookie="consentDate="+escape(r.getTime())+"; domain = "+o+";"+a+" path=/",this.getCookie("consentDate")||(document.cookie="consentDate="+escape(r.getTime())+";"+a+" path=/")}document.cookie=e+"="+escape(n)+"; domain = "+o+";"+a+" path=/",this.getCookie(e)||(logManager.warning("cookie "+e+" creation failed. (domain used: "+o+")"),document.cookie=e+"="+escape(n)+";"+a+" path=/",logManager.warning("cookie "+e+" creation without domain succeeded"))},this.getCookie=function(e){var n=document.cookie.match(new RegExp(e+"=([^;]+)"));return n?unescape(n[1]):null}},RequestPlatform=function(){var i=this,r=0,c=configManager.getConfigurations().MAXIMUM_NUMBER_CONSENTS_RETRIES||1;this.getConsentGET=function(a,n){var o="RequestPlatform.getConsent()";logManager.log(o);var e=configManager.getConfigurations().API_ENDPOINT+"consents";1==configManager.getConfigurations().DUMMY_API&&(e+="/getConsentsDummy.json");var t="",s="";null!=consentManager.getModel()&&null!=consentManager.getModel().tvId&&(t="tvId="+consentManager.getModel().tvId,s="?"),logManager.log(o+" "+e+s+t),$.ajax({type:"GET",url:e,data:t,timeout:configManager.getConfigurations().GET_CONSENT_CALL_TIMEOUT,success:function(e,n,t){logManager.log(o+" - Response : "+JSON.stringify(e,null,4)),a(e)},error:function(e){r<c?(r++,i.getConsentGET(a,n)):(logManager.error(o+" - Error : "+JSON.stringify(e,null,4)),n())}})},this.getConsentPOST=function(n,t,a,o){var s="RequestPlatform.getConsentPOST()";logManager.log(s),o||(o=0);var e=JSON.stringify(a);logManager.log(s+" payload: "+e);var r=configManager.getConfigurations().API_ENDPOINT+"consents";1==configManager.getConfigurations().DUMMY_API&&(r+="/getConsentsDummy.json"),$.ajax({type:"POST",url:r,data:e,contentType:"application/json",dataType:"json",timeout:configManager.getConfigurations().SET_CONSENT_CALL_TIMEOUT,success:function(e){logManager.log("Response "+s+": "+JSON.stringify(e,null,4)),"OK"==e.result?n(e):t(e)},error:function(e){o<c?(o++,i.getConsentPOST(n,t,a,o)):(logManager.error("Error "+s+": "+JSON.stringify(e,null,4)),t())}})}},ConsentsConfirmationOverlayComponent=function(n,e){var t=Constants.CONSENT_CONFIRMATION_DISPLAY_TIME;function a(){$(".consent-section__banner").hide(0,function(){e(),$(".consent-section").empty()})}this.showConsentConfirmationOverlay=function(e){null!=e&&(t=e),n&&n(),$(".consent-section").load("templates/consent/consent__consents-confirmation-overlay.html",function(){$(".consent-section__banner__message").html(labelsManager.getLabel("CONSENT_CONFIRMATION_OVERLAY_TEXT")),$(".consent-section__banner").show(0,function(){yellowButtonEnabled=!0,keyDownTimeout=window.setTimeout(a,t)})})}},ConsentsDirectValidationOverlayComponent=function(n,e){var t=this,a=null,o=Constants.CONSENT_BANNER_DISPLAY_TIME,s=0,r=0;function i(){$(".consent-section__banner").hide(0,function(){t.removeKeyboardEvents(),e(),$(".consent-section").empty()})}function c(e){switch(window.clearTimeout(a),logManager.log("Keyset check - e.keyCode: "+e.keyCode+" e.code: "+e.code),e.keyCode){case KeyEvent.VK_UP:case e.VK_UP:case VK_UP:t.manageUpKeyEvent();break;case KeyEvent.VK_DOWN:case e.VK_DOWN:case VK_DOWN:t.manageDownKeyEvent();break;case KeyEvent.VK_RIGHT:case e.VK_RIGHT:case VK_RIGHT:t.manageRightKeyEvent();break;case KeyEvent.VK_LEFT:case e.VK_LEFT:case VK_LEFT:t.manageLeftKeyEvent();break;case KeyEvent.VK_ENTER:case e.VK_ENTER:case VK_ENTER:t.manageEnterKeyEvent()}e.preventDefault()}this.showConsentDirectValidationOverlay=function(e){null!=e&&(o=e),n&&n(),$(".consent-section").load("templates/consent/consent__consents-direct-validation-overlay.html",function(){t.registerKeyboardEvents(),t.setLabels(),$(".consent-section__banner").show(0,function(){configManager.getConfigurations().CONSENT_DIRECT_DEFAULT_FOCUS&&(r=Number(configManager.getConfigurations().CONSENT_DIRECT_DEFAULT_FOCUS)),s=r,$('.tvium-container [tabindex="'+s+'"]').focus(),a=window.setTimeout(i,o)})})},this.removeKeyboardEvents=function(){keyset.setValue(0),document.removeEventListener("keydown",c),e(),$(".consent-section").empty()},this.registerKeyboardEvents=function(){keyset.setValue(keyset.NAVIGATION),logManager.log("Keyset bound: keyset.NAVIGATION - "+JSON.stringify(app.privateData.keyset)),document.addEventListener("keydown",c)},this.manageDownKeyEvent=function(){try{s<3&&(s++,a=window.setTimeout(i,o),s<=3&&$('.tvium-container [tabindex="'+s+'"]').focus())}catch(e){logManager.error("manageDownKeyEvent()"+e.message)}},this.manageUpKeyEvent=function(){try{-1==s?s++:$(":focus").hasClass("link--reset")?s=Number($(".skipfocus").attr("tabindex"))+1:0<s&&s<=3&&(s--,a=window.setTimeout(i,o)),$('.tvium-container [tabindex="'+s+'"]').focus()}catch(e){logManager.error("manageUpKeyEvent()"+e.message)}},this.manageRightKeyEvent=function(){try{3!=s&&-1!=s||s++,$('.tvium-container [tabindex="'+s+'"]').focus()}catch(e){logManager.error("manageRightKeyEvent()"+e.message)}},this.manageLeftKeyEvent=function(){try{-1==s?s++:4==s&&s--,$('.tvium-container [tabindex="'+s+'"]').focus()}catch(e){logManager.error("manageLeftKeyEvent()"+e.message)}},this.manageEnterKeyEvent=null,this.setEnterKeyEventHandler=function(e){t.manageEnterKeyEvent=e},this.setLabels=function(){$(".consent-section__banner__left__logo").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_LOGO")),$(".consent-section__banner__left__title").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_TITLE")),$(".consent-section__banner__left__message").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_TEXT")),$("#politique").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_TEXT_DOWN_POLITIQUE")),$("#partenaires").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_TEXT_DOWN_PARTENAIRES")),$(".consent-section__banner__right__title").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_RIGHT_TITLE")),$("#buttonOk").val(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_OK_BUTTON")),$("#buttonParameter").val(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_PARAMETERS_BUTTON")),$("#buttonRefuser").val(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_REFUSER_BUTTON"))},this.getCurrentPosition=function(){return s}},ConsentsErrorComponent=function(n,e){var t=this,a=null,o=Constants.CONSENT_BANNER_DISPLAY_TIME;function s(){$(".consent-section__banner").hide(0,function(){window.clearTimeout(a),t.removeKeyboardEvents(),activeContext=null,e(),$(".consent-section").empty()})}function r(e){switch(logManager.log("Keyset check - e.keyCode: "+e.keyCode+" e.code: "+e.code),e.keyCode){case KeyEvent.VK_UP:case e.VK_UP:case VK_UP:break;case KeyEvent.VK_DOWN:case e.VK_DOWN:case VK_DOWN:break;case KeyEvent.VK_RIGHT:case e.VK_RIGHT:case VK_RIGHT:break;case KeyEvent.VK_LEFT:case e.VK_LEFT:case VK_LEFT:break;case KeyEvent.VK_ENTER:case e.VK_ENTER:}e.preventDefault()}this.showConsentError=function(e){activeContext=t,null!=e&&(o=e),n&&n(),$(".consent-section").empty(),$(".consent-section").load("templates/consent/consent__consents-error.html",function(){t.registerKeyboardEvents(),t.setLabels(),$(".consent-section__banner").show(0),a=window.setTimeout(s,o)})},this.removeKeyboardEvents=function(){keyset.setValue(0),document.removeEventListener("keydown",r),e(),$(".consent-section").empty()},this.registerKeyboardEvents=function(){keyset.setValue(keyset.NAVIGATION),document.addEventListener("keydown",r)},this.setLabels=function(){$(".consent-section__banner__message").html(labelsManager.getLabel("CONSENT_ERROR_OVERLAY_TEXT"))}},ConsentsParametersOverlayComponent=function(e,n){var c=this,l=0,g=-1;function t(){return!(l!=g||!$('.tvium-container [tabindex="'+l+'"]').hasClass("skipfocus"))}function a(e){switch(logManager.log("Keyset check - e.keyCode: "+e.keyCode+" e.code: "+e.code),e.keyCode){case KeyEvent.VK_UP:case e.VK_UP:case VK_UP:t()?c.manageDownKeyEvent(yellowButtonEnabled):c.manageUpKeyEvent(yellowButtonEnabled);break;case KeyEvent.VK_DOWN:case e.VK_DOWN:case VK_DOWN:c.manageDownKeyEvent(yellowButtonEnabled);break;case KeyEvent.VK_RIGHT:case e.VK_RIGHT:case VK_RIGHT:t()?c.manageDownKeyEvent(yellowButtonEnabled):c.manageRightKeyEvent();break;case KeyEvent.VK_LEFT:case e.VK_LEFT:case VK_LEFT:t()?c.manageDownKeyEvent(yellowButtonEnabled):c.manageLeftKeyEvent();break;case KeyEvent.VK_ENTER:case e.VK_ENTER:case VK_ENTER:c.manageEnterKeyEvent(yellowButtonEnabled);break;case KeyEvent.VK_BACK:case e.VK_BACK:case VK_BACK:c.manageBackKeyEvent()}e.preventDefault()}this.init=function(e){c.consentModel=e},this.showConsentParametersOverlay=function(i){activeContext=c,e&&e(),$(".consent-section").load("templates/consent/consent__consents-parameters-overlay.html",function(){try{if(c.registerKeyboardEvents(),c.setLabels(),$("#confirmButtonAll").html(labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_CONFIRM_ALL")),$("#refuserButtonAll").html(labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_REFUSER_ALL")),$("#politique").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_TEXT_DOWN_POLITIQUE")),$("#partenaires").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_TEXT_DOWN_PARTENAIRES")),null!=c.consentModel.consents){var e="",n=3,t=" active";c.auxConsentModel=JSON.parse(JSON.stringify(c.consentModel));for(var a=0;a<c.consentModel.consents.length;a++){var o,s=c.consentModel.consents[a],r="";null!=i&&1==i?(r=s.modificationText,null!=s.consentStatus&&(o=s.consentStatus)):(r=s.consentText,o=s.consentStatus),e+='<div class="consent-section__page__contain__text">'+r+'</div><div class="consent-section__page__contain__buttons-container"><button class="consent-section__page__contain__buttons-container__button button '+(5<=n&&1!=i?" disabled":"")+(1==o?t:"")+'" id="t'+a+'" name="'+labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_YES_BUTTON")+'" value="true" tabindex="'+n+'">'+labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_YES_BUTTON")+"</button>",e+='<button class="consent-section__page__contain__buttons-container__button button '+(5<=++n&&1!=i?" disabled":"")+(0==o?t:"")+'" id="f'+a+'" name="'+labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_NO_BUTTON")+'" value="false" tabindex="'+n+'">'+labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_NO_BUTTON")+"</button></div>",n++}$(".consent-section__page__contain__buttons-container-all").after(e)}configManager.getConfigurations().CONSENT_PARAMETERS_DEFAULT_FOCUS&&(g=Number(configManager.getConfigurations().CONSENT_PARAMETERS_DEFAULT_FOCUS)),null!=i&&1==i?($("#confirmButton").focus(),$("#confirmButton").addClass("focused"),$("#headerText").html(labelsManager.getLabel("CONSENT_MODIFICATION_OVERLAY_HEADER_TEXT")),l=parseInt($("#confirmButton").attr("tabindex"))):(l=g,$('.tvium-container [tabindex="'+l+'"]').addClass("focused"),$("#headerText").html(labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_HEADER_TEXT")),$(".consent-section__page__contain__message").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_TEXT")))}catch(e){logManager.error(e.message)}})},this.manageRightKeyEvent=function(){var e;try{e="Oui"==$(".focused").attr("name")||"rowbutton"==$(".focused").attr("name")&&11!=l?1:-1==l?2:0,$("*").removeClass("focused"),l+=e,$('.tvium-container [tabindex="'+l+'"]').hasClass("skipfocus")&&l++,$('.tvium-container [tabindex="'+l+'"]').addClass("focused")}catch(e){logManager.error(e.message)}},this.manageLeftKeyEvent=function(){try{"Non"==$(".focused").attr("name")||11==l?l-=1:"Oui"==$(".focused").attr("name")&&$(".focused").hasClass("all")?l+=9:0,$("*").removeClass("focused"),$('.tvium-container [tabindex="'+l+'"]').hasClass("skipfocus")&&l--,$('.tvium-container [tabindex="'+l+'"]').addClass("focused")}catch(e){logManager.error(e.message)}},this.manageUpKeyEvent=function(e){var n;try{-1!=l&&0!=l?(n="rowbutton"==$(".focused").attr("name")?$("*").hasClass("disabled")?11==l?10:9:11==l?2:1:"Non"==$(".focused").attr("name")?3:2,$("*").removeClass("focused"),l-=n):n=0,$('.tvium-container [tabindex="'+l+'"]').hasClass("skipfocus")&&l--,$('.tvium-container [tabindex="'+l+'"]').addClass("focused")}catch(e){logManager.error(e.message)}},this.manageDownKeyEvent=function(e){var n;try{0!=(n=l==g&&$('.tvium-container [tabindex="'+l+'"]').hasClass("skipfocus")?1:"Oui"==$(".focused").attr("name")&&$('.tvium-container [tabindex="'+(l+2)+'"]').hasClass("button")&&!$('.tvium-container [tabindex="'+(l+2)+'"]').hasClass("disabled")||-1==l?2:"Non"==$(".focused").attr("name")&&$('.tvium-container [tabindex="'+(l+2)+'"]').hasClass("button")&&!$('.tvium-container [tabindex="'+(l+2)+'"]').hasClass("disabled")||"Valider"==$(".focused").attr("name")?1:"Oui"==$(".focused").attr("name")&&3==$("button.active").length?2:"Non"==$(".focused").attr("name")&&3==$("button.active").length?1:0)&&($("*").removeClass("focused"),l+=n,$('.tvium-container [tabindex="'+l+'"]').hasClass("skipfocus")&&l++,$('.tvium-container [tabindex="'+l+'"]').addClass("focused"))}catch(e){logManager.error(e.message)}},this.manageEnterKeyEvent=null,this.manageBackKeyEvent=null,this.manageShowPrivacyPolicy=null,this.manageShowPartner=null,this.manageShowErrorMessage=null,this.getAuxContentModel=function(){return c.auxConsentModel},this.setEnterKeyEventHandler=function(e){c.manageEnterKeyEvent=e},this.setBackKeyEventHandler=function(e){c.manageBackKeyEvent=e},this.fadeOutError=function(){$(".consent-section__banner").fadeOut(1e3,function(){c.removeKeyboardEvents(),n()})},this.removeKeyboardEvents=function(){keyset.setValue(0),document.removeEventListener("keydown",a),n(),$(".consent-section").empty(),activeContext=null},this.registerKeyboardEvents=function(){keyset.setValue(keyset.NAVIGATION),logManager.log("Keyset bound: keyset.NAVIGATION - "+JSON.stringify(app.privateData.keyset)),document.addEventListener("keydown",a)},this.setLabels=function(){$("#backButton").html(labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_BACK_BUTTON")),$("#headerTitle").html(labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_TITLE")),$("#headerButton").text(labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_LEFT_HEADER_BUTTON")),$("#confirmButton").text(labelsManager.getLabel("CONSENT_PARAMETERS_OVERLAY_LEFT_CONFIRM_BUTTON")),$(".consent-section__page__left__message_down_link_1").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_TEXT_DOWN_LINK_1")),$(".consent-section__page__left__message_down_link_2").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_LEFT_TEXT_DOWN_LINK_2")),$(".consent-section__page__title_dx").html(labelsManager.getLabel("CONSENT_DIRECT_VALIDATION_OVERLAY_RIGHT_TITLE"))},this.updateModel=function(e){try{c.consentModel=e}catch(e){logManager.error(e.message)}}},ConsentsPartnerComponent=function(e,n){var t=this,a=2,o=0,s="";function r(e,n){for(var t='<div class="consent-section__page__contain__partenaires__partners__partner_item" id="partner_'+n+'"><div class="consent-section__page__contain__partenaires__partners__partner_item__name">'+e.NAME+"</div><span>"+labelsManager.getLabel("CONSENT_PARTENAIRES_FINALITE")+"</span><ul>",a=0;a<e.CONSENTS.length;a++)t+="<li>"+e.CONSENTS[a].CONSENSNAME+"</li>";return t+='</ul><div class="consent-section__page__contain__partenaires__partners__partner_item__link">'+labelsManager.getLabel("CONSENT_PARTENAIRES_SITE")+'<a href="'+e.URL_POLITIQUE+'">'+e.URL_POLITIQUE+"</a></div></div>"}function i(e){switch(logManager.log("Keyset check - e.keyCode: "+e.keyCode+" e.code: "+e.code),e.keyCode){case KeyEvent.VK_ENTER:case e.VK_ENTER:case VK_ENTER:t.manageEnterKeyEvent();break;case KeyEvent.VK_BACK:case e.VK_BACK:case VK_BACK:t.manageBackKeyEvent();break;case KeyEvent.VK_UP:case e.VK_UP:case VK_UP:t.manageUpKeyEvent();break;case KeyEvent.VK_DOWN:case e.VK_DOWN:case VK_DOWN:t.manageDownKeyEvent();break;case KeyEvent.VK_LEFT:case e.VK_LEFT:case VK_LEFT:t.manageLeftKeyEvent();break;case KeyEvent.VK_RIGHT:case e.VK_RIGHT:case VK_RIGHT:t.manageRightKeyEvent()}e.preventDefault()}this.showConsentPartner=function(n){e&&e(),$(".consent-section").empty(),$(".consent-section").load("templates/consent/consent__consents-partenaires.html",function(){t.registerKeyboardEvents(),t.setLabels(),configManager.getConfigurations().CONSENT_PARTENAIRES_DEFAULT_FOCUS&&(a=Number(configManager.getConfigurations().CONSENT_PARTENAIRES_DEFAULT_FOCUS)),a,$('.tvium-container [tabindex="'+a+'"]').focus(),$('.tvium-container [tabindex="'+a+'"]').addClass("focused"),n&&""!=n&&(s=n),$("#backButton").attr("pagefrom",s);var e=configManager.getConfigurations().API_ENDPOINT+"partners";1==configManager.getConfigurations().DUMMY_API&&(e+="/getPartnerBannerDummy.json"),$.ajax({type:"GET",url:e,contentType:"application/json",dataType:"json"}).done(function(e,n,t){!function(e){var n="";if(e&&e.PARTNERS){var t=e.PARTNERS,a=Object.keys(t);if(0<a.length){for(var o=0;o<a.length;o++){var s=t[a[o]];n+=r(s,o)}$(".consent-section__page__contain__partenaires--txt").html(labelsManager.getLabel("CONSENT_PARTENAIRES_HEADER_TEXT")),$("#politique").html(labelsManager.getLabel("CONSENT_PARTENAIRES_POLITIQUE")),$(".consent-section__page__contain__partenaires__partners").html(n)}}""==n&&$(".consent-section__page__contain__partenaires--txt").html(labelsManager.getLabel("CONSENT_PARTENAIRES_HEADER_EMPTY_TEXT"))}(e)}).fail(function(e,n,t){logManager.log(t)})})},this.manageEnterKeyEvent=null,this.manageBackKeyEvent=null,this.setEnterKeyEventHandler=function(e){t.manageEnterKeyEvent=e},this.setBackKeyEventHandler=function(e){t.manageBackKeyEvent=e},this.manageLeftKeyEvent=function(){var e;if($(".tvium-container .focused")[0])switch(e=$(".tvium-container .focused")[0].id){case"partenairesText":$("#backButton").addClass("focused"),$("#"+e).removeClass("focused")}},this.manageRightKeyEvent=function(){var e;if($(".tvium-container .focused")[0])switch(e=$(".tvium-container .focused")[0].id){case"backButton":$("#partenairesText").addClass("focused"),$("#"+e).removeClass("focused")}},this.manageUpKeyEvent=function(){var e;if($(".tvium-container .focused")[0])switch(e=$(".tvium-container .focused")[0].id){case"partenairesText":$("#partenairesText")[0].scrollTop<=0?($("#backButton").addClass("focused"),$("#"+e).removeClass("focused")):$("#partenairesText")[0].scrollTop=$("#partenairesText")[0].scrollTop-50;break;case"politique":$("#"+e).removeClass("focused"),$("#"+e).removeClass("active"),$("#backButton").addClass("focused")}},this.manageDownKeyEvent=function(){var e,n=$("#partenairesText").height(),t=$(".consent-section__page__contain__partenaires__partners").height()-n;if($(".tvium-container .focused")[0])switch(e=$(".tvium-container .focused")[0].id){case"backButton":$("#partenairesText").addClass("focused"),$("#"+e).removeClass("focused");break;case"partenairesText":50*o<t?($("#partenairesText")[0].scrollTop=$("#partenairesText")[0].scrollTop+50,o+=1):($("#"+e).removeClass("focused"),$("#politique").addClass("focused"),$("#politique").addClass("active"))}},this.removeKeyboardEvents=function(){keyset.setValue(0),document.removeEventListener("keydown",i),n(),$(".consent-section").empty()},this.registerKeyboardEvents=function(){keyset.setValue(keyset.NAVIGATION),document.addEventListener("keydown",i)},this.setLabels=function(){$(".consent-section__page__back-button").html(labelsManager.getLabel("CONSENT_PARTENAIRES_BACK_BUTTON")),$(".consent-section__page__title").html(labelsManager.getLabel("CONSENT_PARTENAIRES_HEADER_TITLE"))}},ConsentsPrivacyPolicyComponent=function(n,e){var t=this,a=0,o=0;function s(e){switch(logManager.log("Keyset check - e.keyCode: "+e.keyCode+" e.code: "+e.code),e.keyCode){case KeyEvent.VK_ENTER:case e.VK_ENTER:case VK_ENTER:t.manageEnterKeyEvent();break;case KeyEvent.VK_BACK:case e.VK_BACK:case VK_BACK:t.manageBackKeyEvent();break;case KeyEvent.VK_UP:case e.VK_UP:case VK_UP:t.manageUpKeyEvent();break;case KeyEvent.VK_DOWN:case e.VK_DOWN:case VK_DOWN:t.manageDownKeyEvent();break;case KeyEvent.VK_LEFT:case e.VK_LEFT:case VK_LEFT:t.manageLeftKeyEvent();break;case KeyEvent.VK_RIGHT:case e.VK_RIGHT:case VK_RIGHT:t.manageRightKeyEvent()}e.preventDefault()}this.showConsentPrivacyPolicy=function(e){n&&n(),$(".consent-section").empty(),$(".consent-section").load("templates/consent/consent__consents-privacy-policy.html",function(){t.registerKeyboardEvents(),t.setLabels(),configManager.getConfigurations().CONSENT_PRIVACY_DEFAULT_FOCUS&&(o=Number(configManager.getConfigurations().CONSENT_PRIVACY_DEFAULT_FOCUS)),a=o,$('.tvium-container [tabindex="'+a+'"]').focus(),$('.tvium-container [tabindex="'+a+'"]').addClass("focused"),$("#backButton").attr("pagefrom",e)})},this.manageEnterKeyEvent=null,this.manageBackKeyEvent=null,this.setEnterKeyEventHandler=function(e){t.manageEnterKeyEvent=e},this.setBackKeyEventHandler=function(e){t.manageBackKeyEvent=e},this.manageLeftKeyEvent=function(){try{0==a&&($("*").removeClass("focused"),a--,$('.tvium-container [tabindex="'+a+'"]').addClass("focused"))}catch(e){logManager.error(e.message)}},this.manageRightKeyEvent=function(){try{-1==a&&($("*").removeClass("focused"),a++,$('.tvium-container [tabindex="'+a+'"]').addClass("focused"))}catch(e){logManager.error(e.message)}},this.manageUpKeyEvent=function(){try{0==a&&($("#privacyPolicyText")[0].scrollTop=$("#privacyPolicyText")[0].scrollTop-50)}catch(e){logManager.error(e.message)}},this.manageDownKeyEvent=function(){try{0==a&&($("#privacyPolicyText")[0].scrollTop=$("#privacyPolicyText")[0].scrollTop+50)}catch(e){logManager.error(e.message)}},this.removeKeyboardEvents=function(){keyset.setValue(0),document.removeEventListener("keydown",s),e(),$(".consent-section").empty()},this.registerKeyboardEvents=function(){keyset.setValue(keyset.NAVIGATION),document.addEventListener("keydown",s)},this.setLabels=function(){$(".consent-section__page__back-button").html(labelsManager.getLabel("CONSENT_PRIVACY_POLICY_BACK_BUTTON")),$(".consent-section__page__title").html(labelsManager.getLabel("CONSENT_PRIVACY_POLICY_HEADER_TITLE")),$(".consent-section__page__contain__politique--upper").html(labelsManager.getLabel("CONSENT_PRIVACY_POLICY_HEADER_TEXT")),$(".consent-section__page__contain__politique--body").html(labelsManager.getLabel("CONSENT_PRIVACY_POLICY_TEXT"))}};