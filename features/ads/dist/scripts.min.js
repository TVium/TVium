var Adv=function(){var r,p=this,m=new AdvHashmap,v=new AdvRequests,E={},o=[];this.ptsHandlerComponent=new PtsHandlerComponent,this.callAdServerRoundTripTime=0;var M={};function f(e){try{var t=JSON.parse(e);if(t.STARTdata.triplet!==serviceManager.getCurrentChannel().getChannelToString())return void logManager.warning("startEventProcess - event triplet ("+t.STARTdata.triplet+") not corresponding to current channel's triplet ("+serviceManager.getCurrentChannel().getChannelToString()+")");m.getValue(t.STARTdata.break_code)?n(e):M.CALL_ADSERVER_FALLBACK_ON_STARTEVENT&&"spot"===M.AD_SUBSTITUTION_METHOD?(logManager.log("startEventProcess - break_code not found in dictionary: triggering callAdServer."),a(e,function(){n(e)})):logManager.warning("startEventProcess - break code not found in dictionary.")}catch(e){logManager.error("startEventProcess - error: "+e.message)}}function a(e,r){try{if(null==featuresManager.getFeature("linearAdTracking")||!0!==featuresManager.getFeature("linearAdTracking"))return void logManager.warning("callAdServerProcess - linearAdTracking feature is not true");if(consent&&(null==consent.getModel()||!0!==consent.getModelConsents().TRACKING.consentStatus))return void logManager.warning("callAdServerProcess - user consent not given to TRACKING");var i=JSON.parse(e);if(0!==Object.keys(E).length&&"break"===M.AD_SUBSTITUTION_METHOD)return void logManager.warning("callAdServerProcess - Discarding Event: Break tracking already in progress.");if(i.LOADdata.triplet!==serviceManager.getCurrentChannel().getChannelToString())return void logManager.warning("callAdServerProcess - event triplet ("+i.LOADdata.triplet+") not corresponding to current channel's triplet ("+serviceManager.getCurrentChannel().getChannelToString()+")");if(m.isAdvIDExists(i.LOADdata.break_code))return void logManager.warning("callAdServerProcess - break code already loaded");if(m.initialize(i.LOADdata.break_code),m.setStatus(i.LOADdata.break_code,m.lstStatus.LOADING),consent&&null==consent.getModel())return void logManager.warning("callAdServerProcess - getWizadsData() the tvId is not retrived yet");i.LOADdata.channel&&(i.LOADdata.channel=i.LOADdata.channel.toUpperCase());var t=consent?consent.getModel().tvId:"",a=t+(new Date).getTime(),n=i.LOADdata.dai_version,o=i.LOADdata.channel,s=i.LOADdata.break_code,g=i.LOADdata.bday||"",l=i.LOADdata.break_duration,d=core.getPlatform().brand.toLowerCase().trim(),c=M.AD_SUBSTITUTION_METHOD,u=M.ADSERVER_URL;u+="?dai_version="+n+"&transaction_id="+a+"&response_type="+c+"&channel="+o+"&break_code="+s+"&break_day="+g+"&break_duration="+l+"&advertising_id="+t+"&platform="+d+"&context=live&current_spot=0";var T=Date.now();v.getWizadsData(u,function(e){var t,a;function n(){logManager.log("breakTracking - Processing break["+t.LOADdata.break_code+"] - Sequence["+a+"] started");var e={LOADdata:t.LOADdata,STARTdata:{break_code:t.STARTdata.break_code,sequence:a,triplet:t.STARTdata.triplet,duration:E.spots[a].duration,pts:0}};null!=E.spots[a+1]&&window.setTimeout(n,E.spots[a].duration+M.BLACK_FRAMES_DURATION_AFTER_SPOT),f(JSON.stringify(e)),a++}p.callAdServerRoundTripTime=Date.now()-T,0!==Object.keys(e).length?(function(e,t){try{E={},logManager.log("createDictionary() - Creating dictionary");var a=t.Ads;if(0<a.length){E.id=e,logManager.log("createDictionary() - dictionary.id: "+E.id),E.spots=[];for(var n=0;n<a.length;n++)E.spots[parseInt(a[n].Sequence)]=function(e){var t;return(t=function(e){try{var t={},a=e.InLine.Creatives[0].Linear.Duration;t.duration=1e3*+a,t.tracking={};var n=e.InLine.Creatives[0].Linear.TrackingEvents;t.tracking.impression=e.InLine.Impressions[0].Data.trim();for(var r=0;r<n.length;r++)switch(n[r].Event){case"firstQuartile":t.tracking.firstQuartile=n[r].Data.trim();break;case"midpoint":t.tracking.midpoint=n[r].Data.trim();break;case"thirdQuartile":t.tracking.thirdQuartile=n[r].Data.trim();break;case"complete":t.tracking.complete=n[r].Data.trim()}var i=e.InLine.Creatives[0].Linear.MediaFiles[0].Data.trim();return t.media_file_url=i,t.media_file_type="addressed",-1!==i.indexOf("broadcasted")&&(t.media_file_type="broadcasted"),t}catch(e){logManager.error("createTrackingItemsForDictionary: "+e)}}(e)).companionAd=function(e){try{var t={};return t=null!=e.InLine.Creatives[0].CompanionAds?e.InLine.Creatives[0].CompanionAds:t}catch(e){logManager.error("createCompanionAdForDictionary: "+e)}}(e),t}(a[n]),logManager.log("createDictionary() - dictionary.spots["+parseInt(a[n].Sequence)+"] tracking items loaded")}else logManager.log("createDictionary() - no Ads found in VAST file.")}catch(e){logManager.error("createDictionary: "+e)}}(i.LOADdata.break_code,e),m.setValue(i.LOADdata.break_code,E,m.type.STREAMEVENT),m.setStatus(i.LOADdata.break_code,m.lstStatus.LOADED),null!=r&&r(),"break"===M.AD_SUBSTITUTION_METHOD&&(a=(t=i).STARTdata.sequence,featuresManager.getFeature("PTSMethod")?(logManager.warning("breakTracking - Waiting first START PTS time in order to start tracking queue."),p.ptsHandlerComponent.ptsStartEventTimeCheck(t.STARTdata.pts,t,n)):(logManager.warning("breakTracking - no PTS or Delay method for this client in the feature file. Queuing starts immediately."),n()))):logManager.log("callAdServerProcess - VAST file is an empty object.")},function(e){S(i.LOADdata.break_code),logManager.error("getWizadsData() KO Response")})}catch(e){logManager.error("callAdServerProcess - error: "+e.message)}}function n(e){var t=JSON.parse(e),a=m.getValue(t.STARTdata.break_code);if(a.status===m.lstStatus.LOADED||a.status===m.lstStatus.STARTED)if(m.setStatus(t.STARTdata.break_code,m.lstStatus.STARTED),E.spots.hasOwnProperty(t.STARTdata.sequence))if(logManager.log("startEventProcessPostValidation - Event payload: "+e),t.STARTdata.duration===E.spots[t.STARTdata.sequence].duration)switch(M.AD_SUBSTITUTION_METHOD){case"spot":featuresManager.getFeature("PTSMethod")?p.ptsHandlerComponent.ptsStartEventTimeCheck(t.STARTdata.pts,t,i):logManager.warning("startEventProcess - no PTS or Delay method for this client in the feature file.");break;case"break":i(t);break;default:logManager.warning('startEventProcess - no "break" or "spot" mode enabled.')}else logManager.warning("startEventProcess - spot duration in Stream Event payload ("+t.STARTdata.duration+") not matching the VAST duration for this spot ("+E.spots[t.STARTdata.sequence].duration+")");else logManager.warning("startEventProcess - sequence not found: "+t.STARTdata.sequence);else logManager.warning("startEventProcess - incorrect status : "+a.status)}function i(e){m.getValue(e.STARTdata.break_code)?!consent||null!=consent.getModel()&&!0===consent.getModelConsents().TRACKING.consentStatus?featuresManager.getFeature("linearAdTracking")&&!0===featuresManager.getFeature("linearAdTracking")&&s(e.STARTdata.sequence,e.STARTdata.break_code):(logManager.warning("startEventCoreProcess - user consent not given to TRACKING"),l(e.STARTdata.break_code,e.STARTdata.sequence)):logManager.warning("startEventCoreProcess - break code not found")}function s(t,a){try{var e,n;null!=E&&0<Object.keys(E).length&&null!=t&&E.id===a?(e=E.spots[t].duration/4,n=0,g(E.spots[t].tracking.impression,"impression",t),r=window.setInterval(function(){switch(++n){case 1:g(E.spots[t].tracking.firstQuartile,"firstQuartile",t);break;case 2:g(E.spots[t].tracking.midpoint,"midpoint",t);break;case 3:g(E.spots[t].tracking.thirdQuartile,"thirdQuartile",t);break;case 4:!function(e,t){g(E.spots[e].tracking.complete,"complete",e),r&&window.clearInterval(r);l(t,e),logManager.log("Adv pixel tracking schedulation ended.")}(t,a)}},e)):logManager.warning("scheduleSpotTracking - empty dictionary")}catch(e){logManager.error("scheduleSpotTracking: "+e),l(a,t)}}function g(e,t,a){if(trace&&trace.injectTrackingPixel(e),M.VISIBLE_AD_TRACKING)switch(t){case"impression":case"complete":!function(e,t,a){var n=$(".trackingPopupContainer"),r="5%";1<=n.length&&(r="50%");var i=$("<div class='trackingPopupContainer' style='position:absolute; top:"+r+"; left:65px; width: 50%; padding:5px; z-index: 9999; background-color:rgba(255,255,255,0.7); color:#000; border:1px solid #000; word-break: break-all;'><b>Sequence: </b>"+a+"<br /><b>Tracking: </b>"+$.camelCase(e)+"<br /><b>URL: </b> "+escapeXml(t)+"</div>");$(".tvium-container").append(i),window.setTimeout(function(){i.remove()},3e3)}(t,e,a)}logManager.log("Sequence["+a+"] - "+t+" pixel image loaded - "+escapeXml(e))}function l(e,t){E.spots.hasOwnProperty(t)?(delete E.spots[t],0===Object.keys(E.spots).length&&(S(e),m.clearLst(),E={},logManager.log("All spots of the break has been removed!"))):logManager.warning("removeSpotFromDictionary - "+t+" not found")}function S(e){m.isAdvIDExists(e)?(m.setStatus(e,m.lstStatus.STOP),m.deleteAdv(e)):logManager.warning("clearAdv - event ID not found")}return{configure:function(e){M=e},getConfiguration:function(){return M},onFiredAdv:function(e){"spot"===M.AD_SUBSTITUTION_METHOD?f(e.text):"break"===M.AD_SUBSTITUTION_METHOD?a(e.text,null):logManager.warning("onAdEventReceived - No SpotMode or BreakMode set in the configuration.")},callAdServerProcess:a,callVastAdServerProcess:function(e,t,a){m.isAdvIDExists(t.segmentation_upid)?logManager.warning("callAdServerProcess - break code already loaded"):(m.initialize(t.segmentation_upid),m.setStatus(t.segmentation_upid,m.lstStatus.LOADING),v.doFreewheelAdCall(e,t,a,function(e){e&&0===e.getElementsByTagNameNS("http://www.iab.net/vmap-1.0","VMAP").length?logManager.log("onFiredSCTEAdv - VAST file is an empty object."):(function(e,t){try{E={},logManager.log("createDictionaryVAST() - Creating dictionary");var a=t.getElementsByTagNameNS("http://www.iab.net/vmap-1.0","VMAP")[0].getElementsByTagNameNS("http://www.iab.net/vmap-1.0","AdBreak");if(0==a.length)logManager.log("createDictionaryVAST() - no Ad Break found in VAST file.");else{var n=a[0].getElementsByTagNameNS("http://www.iab.net/vmap-1.0","AdSource")[0].getElementsByTagNameNS("http://www.iab.net/vmap-1.0","VASTAdData")[0].getElementsByTagName("VAST")[0].getElementsByTagName("Ad");if(0<n.length){E.id=e,logManager.log("createDictionaryVAST() - dictionary.id: "+E.id),E.spots=[];for(var r=0;r<n.length;r++)E.spots[parseInt(n[r].getAttribute("sequence"))]=function(e){try{var t={},a=e.getElementsByTagName("InLine")[0].getElementsByTagName("Creatives")[0].getElementsByTagName("Creative")[0].getElementsByTagName("Linear")[0].getElementsByTagName("Duration")[0].textContent.split(":");t.duration=60*+a[0]*60+60*+a[1]+1e3*+a[2],t.tracking={};var n=e.getElementsByTagName("InLine")[0].getElementsByTagName("Creatives")[0].getElementsByTagName("Creative")[0].getElementsByTagName("Linear")[0].getElementsByTagName("TrackingEvents")[0].getElementsByTagName("Tracking");t.tracking.impression=e.getElementsByTagName("InLine")[0].getElementsByTagName("Impression")[0].textContent.trim();for(var r=0;r<n.length;r++)switch(n[r].getAttribute("event")){case"firstQuartile":t.tracking.firstQuartile=n[r].textContent.trim();break;case"midpoint":t.tracking.midpoint=n[r].textContent.trim();break;case"thirdQuartile":t.tracking.thirdQuartile=n[r].textContent.trim();break;case"complete":t.tracking.complete=n[r].textContent.trim()}var i=e.getElementsByTagName("InLine")[0].getElementsByTagName("Creatives")[0].getElementsByTagName("Creative")[0].getElementsByTagName("Linear")[0].getElementsByTagName("MediaFiles")[0].getElementsByTagName("MediaFile")[0].textContent.trim();return t.media_file_url=i,t.media_file_type="broadcasted",-1===i.indexOf(".mp4")&&-1===i.indexOf(".mpd")||(t.media_file_type="addressed"),t}catch(e){logManager.error("createTrackingItemsForDictionary: "+e)}}(n[r]),logManager.log("createDictionaryVAST() - dictionary.spots["+parseInt(n[r].getAttribute("sequence"))+"] tracking items loaded")}else logManager.log("createDictionaryVAST() - no Ads found in VAST file.")}}catch(e){logManager.error("createDictionaryVAST: "+e)}}(t.segmentation_upid,e),function(){if(null!=E.spots&&(logManager.log("createVideoPlayers - linearAdSwitch "+featuresManager.getFeature("linearAdSwitch")),null!=featuresManager.getFeature("linearAdSwitch")&&!1!==featuresManager.getFeature("linearAdSwitch")))for(var e=0;e<E.spots.length;e++)null!=E.spots[e]&&"addressed"===E.spots[e].media_file_type&&(logManager.log("dictionary spot number "+e+" has a valid url"),o[e]=new PlayerADS(function(){},"_"+e),o[e].setUrl(E.spots[e].media_file_url,!0))}(),m.setValue(t.segmentation_upid,E,m.type.STREAMEVENT),m.setStatus(t.segmentation_upid,m.lstStatus.LOADED))},function(e){S(t.segmentation_upid),logManager.error("doFreewheelAdCall() KO Response")}))},startProcess:f,startSCTEProcess:function(n,r){function e(e){var t,a;10<e&&window.clearInterval(i),(a=m.getLoadedAdv())?(e=m.getValue(a)).status===m.lstStatus.LOADED||e.status===m.lstStatus.STARTED?(m.setStatus(a,m.lstStatus.STARTED),n.segmentation_upid=a,t=n,a=r,p.ptsHandlerComponent.ptsStartEventTimeCheck(a.splice_event.pts_time,null,function(){featuresManager.getFeature("linearAdTracking")&&!0===featuresManager.getFeature("linearAdTracking")&&s(t.segment_num,t.segmentation_upid),o[t.segment_num]&&o[t.segment_num].canPlay()?(o[t.segment_num].play(),logManager.log("videoPlayers["+t.segment_num+"] started playing.")):logManager.log("videoPlayers["+t.segment_num+"] play aborted: canPlay check failed")}),window.clearInterval(i)):logManager.warning("startSCTEProcess - incorrect status : "+e.status):logManager.warning("startSCTEProcess - no dictionary loaded with "+n.segmentation_upid)}var t,i=null;r.segmentation_type_id_list&&-1<r.segmentation_type_id_list.indexOf(2)?(t=0,i=setInterval(function(){e(t++)},1e3)):e()}}},AdvHashmap=function(){var n={status:null,dictionary:null},a=null,r={LOADING:"LOADING",LOADED:"LOADED",STARTING:"STARTING",STARTED:"STARTED",STOP:"STOP"};function i(e){return e in n}return{deleteAdv:function(e){delete n[e],logManager.log("deleteAdv -  Adv Deleted!")},initialize:function(e){n[e.toString()]={status:null,dictionary:null}},setValue:function(e,t,a){i(e)||(n[e]={}),n[e].dictionary=t,n[e].type=a},getValue:function(e){return i(e)?n[e]:null},setStatus:function(e,t){i(e)?(n[e].status=t)==r.LOADED?a=e:t==r.STOP&&(a=null,logManager.log("Status: "+t)):logManager.warning("Adv ID not found: "+e)},isAdvIDExists:i,isAdvAlreadyLoaded:function(){return null!=a},lstStatus:r,type:{STREAMEVENT:"STREAMEVENT"},clearLst:function(){n={},a=null},lstAdvIsEmpty:function(){return 0==Object.keys(n).length||0==Object.keys(n).length},getLoadedAdv:function(){return a}}},PlayerADS=function(e,t){var a=null,n=null,r=this,i=!1,o=t||"";this.setUrl=function(e,t){n=e,a=new VideoHTML5(r),logManager.log("HTML5 player"),a.createHtmlObjects(),a.setUrl(n),t&&a.load()},this.onVideoPlayStarted=function(){},this.onVideoError=function(){},this.onVideoEndVideo=function(){2!==featuresManager.getFeature("numberOfVideoDecoders")&&serviceManager.startBroadcast(),e()},this.onProgressVideo=function(e,t){},this.onSeeked=function(){},this.onCanPlay=function(){i=!0},this.play=function(){logManager.log("PlayerADS - play() "),a?(2!==featuresManager.getFeature("numberOfVideoDecoders")&&serviceManager.stopBroadcast(),a.play()):logManager.log("skipping play() - video player not initialized yet (probably due to prefetch not completed)")},this.isPlaying=function(){return a.isPlaying()},this.stop=function(){a.stop(),a=null,r.onVideoEndVideo()},this.canPlay=function(){return!(!n||0!=n.indexOf("http"))&&i},this.getDomId=function(){return o}},PtsHandlerComponent=function(){this.ptsStartEventTimeCheck=function(a,n,r){null!=mediaSyncManager.getCurrentTime()?(logManager.log("ptsStartEventTimeCheck - currentTime: "+mediaSyncManager.getCurrentTime()+" - PTS check starting in "+(a-mediaSyncManager.getCurrentTime()-adv.getConfiguration().PTS_CHECK_START_TIME-featuresManager.getFeature("ptsSpotModeSwitchInDurationFineTuning"))+"Ms."),setTimeout(function(){var t=setInterval(function(){var e=mediaSyncManager.getCurrentTime();logManager.log("MediaSynchroniser.currentTime = "+e+" - Event PTS time = "+a+" - Time difference = "+(Math.abs(a-e)-featuresManager.getFeature("ptsSpotModeSwitchInDurationFineTuning"))),a-e-featuresManager.getFeature("ptsSpotModeSwitchInDurationFineTuning")+adv.getConfiguration().PTS_CHECK_TOLERANCE<0&&(logManager.warning("ptsStartEventTimeCheck - payload PTS already expired. We can't go back in time Morty!"),window.clearInterval(t)),Math.abs(a-e-featuresManager.getFeature("ptsSpotModeSwitchInDurationFineTuning"))<=adv.getConfiguration().PTS_CHECK_TOLERANCE&&(r(n),window.clearInterval(t))},adv.getConfiguration().PTS_CHECK_INTERVAL_TIME+featuresManager.getFeature("PTSCheckIntervalFineTuning"))},a-mediaSyncManager.getCurrentTime()-adv.getConfiguration().PTS_CHECK_START_TIME-featuresManager.getFeature("ptsSpotModeSwitchInDurationFineTuning"))):logManager.error("ptsStartEventTimeCheck - MediaSynchroniser not available")}},VideoHTML5=function(a){var n=null,r=null,e=this,i=a.getDomId(),o=!1;function s(){logManager.log("VideoHTML5Manager - onEnded"),t(),a.onVideoEndVideo()}function g(){logManager.log("VideoHTML5Manager - onEmptied")}function l(e){try{o=!0;var t="undefined";if(e&&e.target.error)switch(e.target.error.code){case 1:t="fetching process aborted by user";break;case 2:t="error occurred when downloading";break;case 3:t="error occurred when decoding";break;case 4:t="audio/video not supported"}else t="Error object not defined";logManager.error("VideoHTML5Manager - "+t)}catch(e){logManager.error("VideoHTML5Manager - "+e.message)}a.onVideoError()}function d(){logManager.log("VideoHTML5Manager -  abort event triggered"),o?logManager.log("abort event ignored because triggered by network error"):t()}function c(){logManager.log("VideoHTML5Manager -  play event triggered"),o=!1}function u(){logManager.log("VideoHTML5Manager - Seeked"),a.onSeeked()}function T(){a.onCanPlay(),logManager.log("VideoHTML5Manager - canplay")}function p(){logManager.log("VideoHTML5Manager - canplaythrough")}function m(){logManager.log("VideoHTML5Manager - loadedmetadata")}function v(){logManager.log("VideoHTML5Manager - loadstart")}function E(e){logManager.log("VideoHTML5Manager - "+e.type)}function M(e){logManager.log("VideoHTML5Manager - "+e.type)}function f(e){logManager.log("VideoHTML5Manager - "+e.type)}function S(){}function A(){logManager.log("VideoHTML5Manager - pause")}function y(){logManager.log("VideoHTML5Manager - playing "),a.onVideoPlayStarted()}function h(){var e;if(n){try{e=n.currentTime}catch(e){logManager.warning("prop currentTime not supported")}a.onProgressVideo(e,n.duration)}else logManager.warning("videoObj not set")}function t(){try{n&&e.stop(),r=n=null,$("#videoContainer"+i).remove(),n=null}catch(e){logManager.log("VideoHTML5Manager - clearVideo() - "+e.message)}}this.createHtmlObjects=function(){try{var e=$("<div id='videoContainer"+i+"' class='fullscreenVideoBroadbandContainer hidden'></div>")[0],t=$("<video id='videoBB"+i+"' class='fullscreenVideoBroadband'></video>")[0];e.appendChild(t),document.body.appendChild(e),n=document.getElementById("videoBB"+i),r=document.getElementById("videoContainer"+i),n.addEventListener("ended",s),n.addEventListener("emptied",g),n.addEventListener("error",l),n.addEventListener("abort",d),n.addEventListener("play",c),n.addEventListener("seeked",u),n.addEventListener("canplay",T),n.addEventListener("canplaythrough",p),n.addEventListener("loadedmetadata",m),n.addEventListener("loadstart",v),n.addEventListener("waiting",E),n.addEventListener("stalled",M),n.addEventListener("suspend",f),n.addEventListener("progress",S),n.addEventListener("pause",A),n.addEventListener("playing",y),n.addEventListener("timeupdate",h)}catch(e){logManager.log("createHtmlObjects() : "+e.message)}},this.seek=function(e){try{if(e>n.duration)return;n.currentTime=e}catch(e){logManager.log("error seeking: "+e.message)}},this.load=function(){logManager.log("VideoHTML5Manager - load()"),n.load()},this.setUrl=function(e){logManager.log("VideoHTML5Manager - setURL("+e+")");try{e.match(/.mp4/)?n.setAttribute("type","video/mp4"):n.setAttribute("type","application/dash+xml"),n.src=e}catch(e){logManager.warning("VideoHTML5Manager - "+e.message)}},this.play=function(e){logManager.log("VideoHTML5Manager - play()");try{r.className=r.className.replace(/\bhidden\b/g,""),n.play()}catch(e){logManager.warning("VideoHTML5Manager - "+e.message),t()}},this.isPlaying=function(){return n&&!n.paused},this.getDuration=function(){return n?n.duration:0},this.getCurrentTime=function(){return n?Math.round(n.currentTime):0},this.stop=function(){try{if(n){n.removeEventListener("ended",s),n.removeEventListener("emptied",g),n.removeEventListener("error",l),n.removeEventListener("abort",d),n.removeEventListener("play",c),n.removeEventListener("seeked",u),n.removeEventListener("canplay",T),n.removeEventListener("loadedmetadata",m),n.removeEventListener("loadstart",v),n.removeEventListener("waiting",E),n.removeEventListener("stalled",M),n.removeEventListener("suspend",f),n.removeEventListener("progress",S),n.removeEventListener("pause",A),n.removeEventListener("playing",y),n.removeEventListener("timeupdate",h),n.pause(),n.src="";try{n.removeAttribute("src")}catch(e){}n.load(),n.parentNode.removeChild(n),n=null}}catch(e){logManager.log("VideoHTML5Manager - stop() - "+e.message)}},this.pause=function(){logManager.log("VideoHTML5Manager -  pause()");try{n.pause()}catch(e){logManager.warning(e)}}},AdvRequests=function(){var s=0;this.getWizadsData=function(n,r,i){var o="AdvRequests.getWizadsData()",e=n;logManager.log(o+" CALLED - url: "+n),$.ajax({type:"GET",contentType:"application/json",dataType:"json",url:e,timeout:adv.getConfiguration().GET_WIZADS_TIMEOUT,success:function(e,t,a){logManager.log(o+" - Response : OK"),r(e)},error:function(e,t,a){logManager.error(o+" - Error : "+JSON.stringify(a,null,4)),"timeout"===t&&s<1&&(s++,self.getWizadsData(n,r,i)),i()}})},this.doFreewheelAdCall=function(e,t,a,n,r){null==t.segmentation_duration&&(t.segmentation_duration="");var i="AdvRequests.doFreewheelAdCall()",o=consent?consent.getModel().tvId:"",t="https://"+e.ADSERVER_FREEWHEEL_NET_DOMAIN+".v.fwmrm.net/ad/g/1?nw="+e.ADSERVER_FREEWHEEL_FW_NET_ID+"&mode="+e.ADSERVER_FREEWHEEL_FW_MODE+"&prof="+e.ADSERVER_FREEWHEEL_FW_PLAYER_PROFILE+"&caid="+e.ADSERVER_FREEWHEEL_FW_CAID+"&csid="+e.ADSERVER_FREEWHEEL_FW_CSID+"&resp="+e.ADSERVER_FREEWHEEL_FW_RESP+"&metr="+e.ADSERVER_FREEWHEEL_FW_METR+"&vrdu="+t.segmentation_duration+"&flag="+e.ADSERVER_FREEWHEEL_FW_FLAG+";_fw_hylda=acid="+e.acid+"%26aiid="+t.segmentation_upid+"%26abid%3Dbreak://"+t.segmentation_upid+"&_fw_vcid2="+o+"&tvium=yes;slid="+t.segmentation_upid+"&tpcl="+e.ADSERVER_FREEWHEEL_FW_TPCL+"&ptgt="+e.ADSERVER_FREEWHEEL_FW_TPCL.ADSERVER_FREEWHEEL_FW_PTGT+"&maxd="+t.segmentation_duration+"&mind="+t.segmentation_duration;logManager.log(i+" CALLED - url: "+t),$.ajax({type:"GET",dataType:"xml",url:t,success:function(e,t,a){logManager.log(i+" - Response : OK"),n(e)},error:function(e,t,a){logManager.error(i+" - Error : "+JSON.stringify(a,null,4)),r()}})}};